import{b as h}from"./chunk-GZQ4FD6F.js";import{a as T}from"./chunk-D25W27KK.js";import{c as b,d as v}from"./chunk-YILQFIBY.js";import{b as g,f as d,p as f}from"./chunk-NVHJHBK7.js";import{B as l,N as m,U as p,a as c,fa as u,ia as C,kb as i,oa as a}from"./chunk-VFLFNRAE.js";function y(t){return class extends t{clone(o){let n=this.constructor;return Object.assign(new n,this,o)}}}var r=class extends y(T){constructor(o="",n="user"){super();this.content=o;this.role=n}end_turn;function_call;tool_calls};var M=class t{http=a(g);urlService=a(d);store=a(h);messages=i([]);status=i(!1);conversationId=i("");sendMessage(s,o){let n=`${this.urlService.URLS.CHAT}/${o}`;return this.messages.update(e=>[...e,new r(s,"user")]),this.http.post(n,c(c({messages:this.messages()},this.store.streamId()?{stream_id:this.store.streamId()}:null),this.conversationId()?{conversation_id:this.conversationId()}:null)).pipe(m(e=>{throw new r().clone({content:e.message,role:"error"}),new Error(e)})).pipe(l(e=>(e.message.content=b(v(e.message.content,e.message)),e.message=new r().clone(e.message),this.conversationId.set(e.message.conversation_id),this.messages.update(x=>[...x,e.message]),e)))}botNameCtrl=new f("website",{nonNullable:!0});onBotNameChange(){return this.botNameCtrl.valueChanges.pipe(p(),u(()=>{this.conversationId.set(""),this.messages.set([])}))}static \u0275fac=function(o){return new(o||t)};static \u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"})};export{M as a};
