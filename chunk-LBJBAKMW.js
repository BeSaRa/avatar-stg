import{Ga as R,a as o,b as g,ha as b,i as T,ib as j,jb as w,na as v,uc as i,vc as m,wc as A}from"./chunk-2ZKSTJ2X.js";var H=new WeakMap,s=Symbol("STATE_SOURCE");function S(e,...t){e[s].update(n=>t.reduce((r,d)=>o(o({},r),typeof d=="function"?d(r):d),n)),_(e)}function p(e){return e[s]()}function x(e){return H.get(e[s][T])||[]}function _(e){let t=x(e);for(let n of t){let r=m(()=>p(e));n(r)}}function C(e){let t=m(()=>e());return J(t)?new Proxy(e,{get(n,r){return r in t?(j(n[r])||Object.defineProperty(n,r,{value:i(()=>n()[r]),configurable:!0}),C(n[r])):n[r]}}):e}function J(e){return e?.constructor===Object}function D(...e){let t=[...e],n=typeof t[0]=="function"?{}:t.shift(),r=t;return(()=>{class c{constructor(){let a=r.reduce((f,W)=>W(f),L()),{stateSignals:l,computedSignals:U,methods:N,hooks:O}=a,k=o(o(o({},l),U),N);this[s]=n.protectedState===!1?a[s]:a[s].asReadonly();for(let f in k)this[f]=k[f];let{onInit:y,onDestroy:I}=O;y&&y(),I&&v(R).onDestroy(I)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=b({token:c,factory:c.\u0275fac,providedIn:n.providedIn||null})}return c})()}function L(){return{[s]:w({}),stateSignals:{},computedSignals:{},methods:{},hooks:{}}}function E(e){return t=>{let n=e(o(o({},t.stateSignals),t.computedSignals));return Object.keys(n),g(o({},t),{computedSignals:o(o({},t.computedSignals),n)})}}function M(e){return t=>{let n=o(o(o({[s]:t[s]},t.stateSignals),t.computedSignals),t.methods),r=typeof e=="function"?e(n):e,d=c=>{let u=r[c],a=t.hooks[c];return u?()=>{a&&a(),u(n)}:a};return g(o({},t),{hooks:{onInit:d("onInit"),onDestroy:d("onDestroy")}})}}function h(e){return t=>{let n=e(o(o(o({[s]:t[s]},t.stateSignals),t.computedSignals),t.methods));return Object.keys(n),g(o({},t),{methods:o(o({},t.methods),n)})}}function P(e){return t=>{let n=typeof e=="function"?e():e,r=Object.keys(n);t[s].update(c=>o(o({},c),n));let d=r.reduce((c,u)=>{let a=i(()=>t[s]()[u]);return g(o({},c),{[u]:C(a)})},{});return g(o({},t),{stateSignals:o(o({},t.stateSignals),d)})}}var K={speechToken:{token:"",region:""},streamId:"",recording:"Stopped",streamingStatus:"Stopped",streamReady:!1,backgroundColor:"#8A1538",backgroundUrl:"assets/images/background.svg",logoUrl:"assets/images/MME-logo.png",isVideo:!1,preview:!1,videoToken:""},F=D({providedIn:"root",protectedState:!0},P(K),E(({streamId:e,speechToken:t,recording:n,streamingStatus:r})=>({hasToken:i(()=>!!t().token),hasRegion:i(()=>!!t().region),isRecordingStarted:i(()=>n()==="Started"),isRecordingStopped:i(()=>n()==="Stopped"),isRecordingLoading:i(()=>n()==="InProgress"),hasStream:i(()=>!!e()),isStreamStarted:i(()=>r()==="Started"),isStreamStopped:i(()=>r()==="Stopped"),isStreamLoading:i(()=>r()==="InProgress"||r()==="Disconnecting")})),h(e=>({updateSpeechToken:(t={token:"",region:""})=>{S(e,{speechToken:t})},updateStreamId:t=>{S(e,{streamId:t})},recordingStarted:()=>{S(e,{recording:"Started"})},recordingStopped:()=>{S(e,{recording:"Stopped"})},recordingInProgress:()=>{S(e,{recording:"InProgress"})},updateStreamStatus:(t="Stopped")=>{S(e,{streamingStatus:t})}})),h(e=>({updateState(t){S(e,t)}})),M(e=>{let t=localStorage.getItem("CURRENT_STATE");if(t)S(e,JSON.parse(t));else{let n=p(e);localStorage.setItem("CURRENT_STATE",JSON.stringify(n))}return{onInit(){A(()=>{let n=p(e);localStorage.setItem("CURRENT_STATE",JSON.stringify(n))})}}}));export{p as a,F as b};
